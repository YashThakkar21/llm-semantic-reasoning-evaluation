{
  "id": 218,
  "raw_solution": "    max_so_far = min_ending = max_ending = arr[0]\n    for n in arr[1:]:\n        min_ending, max_ending = min(n, min_ending * n, max_ending * n), max(n, min_ending * n, max_ending * n)\n        max_so_far = max(max_so_far, max_ending)\n    return max_so_far\n",
  "test_code": "assert max_subarray_product_sum([[2,3,-2,4],[1,2,3,4],[-1,-2,-3,-4]]) == 54\nassert max_subarray_product_sum([[0,2],[3,4],[5,6]]) == 44\nassert max_subarray_product_sum([[-2,0,-1],[3,0,3],[-4,4,-1]]) == 19",
  "raw_problem": "# Write a function to find the maximum product subarray of the given array.\ndef max_subarray_product(arr):\n",
  "new_solution": "    def max_subarray_product(sub_arr):\n        max_so_far = min_ending = max_ending = sub_arr[0]\n        for n in sub_arr[1:]:\n            min_ending, max_ending = min(n, min_ending * n, max_ending * n), max(n, min_ending * n, max_ending * n)\n            max_so_far = max(max_so_far, max_ending)\n        return max_so_far\n\n    total_sum = 0\n    for row in arr:\n        total_sum += max_subarray_product(row)\n    return total_sum\n",
  "new_problem": "# Given a 2D array where each element is an array of integers, find the maximum product subarray for each row and then return the sum of these maximum products.\ndef max_subarray_product_sum(arr):\n"
}